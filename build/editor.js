(()=>{"use strict";const e=window.wp.blocks,t=window.wp.compose,o=window.wp.blockEditor,r=window.wp.components,n=window.wp.data,i=window.wp.hooks,s=window.wp.i18n,l=window.ReactJSXRuntime;function c(e){for(const t of e){if("wmf-reports/table-of-contents"===t.name)return!0;if(e.innerBlocks&&c(e.innerBlocks))return!0}return!1}const a=(0,t.createHigherOrderComponent)((e=>t=>{const i=t.isSelected&&"core/group"===t.name,a=(0,n.useSelect)((e=>!!i&&c(e("core/editor").getBlocks())),[i]);if(!i)return(0,l.jsx)(e,{...t},"edit");const{attributes:p,setAttributes:u}=t;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(e,{...t},"edit"),(0,l.jsx)(o.InspectorControls,{children:(0,l.jsxs)(r.PanelBody,{title:(0,s.__)("Report group settings","wmf-reports"),initialOpen:!0,children:[a&&(0,l.jsx)(r.ToggleControl,{label:(0,s.__)("Include in Report Table of Contents","wmf-reports"),checked:p.includeInToC,onChange:e=>{u({includeInToC:e})}}),(p.includeInToC||!a)&&(0,l.jsx)(r.TextControl,{label:a?(0,s.__)("Table of Contents Label","wmf-reports"):(0,s.__)("Container anchor label","wmf-reports"),value:p.tocLabel,onChange:e=>{const t=e.toLowerCase().replace(/[^a-z0-9]/g," ").trim().split(/\s+/).join("-");u({tocSlug:t?`toc-${t}`:"",tocLabel:e})}}),(0,l.jsx)(r.ToggleControl,{label:(0,s.__)("Fill viewport height","wmf-reports"),checked:p.fullViewportHeight,onChange:e=>{u({fullViewportHeight:e})},help:(0,s.__)("Makes this group take up at minimum a full viewport of vertical space","wmf-reports")})]})})]})}),"withCustomGroupControls");(0,i.addFilter)("editor.BlockEdit","wmf-reports/add-group-block-controls",a);const p=(0,t.createHigherOrderComponent)((e=>t=>{if("core/group"!==t.name||!t.attributes.fullViewportHeight)return(0,l.jsx)(e,{...t});const o=`${t.className||""} wp-block-group-is-full-viewport-height`;return(0,l.jsx)(e,{...t,className:o})}),"withFillViewportHeightStyle");(0,i.addFilter)("editor.BlockListBlock","wmf-reports/block-list-block/group-block",p,100),(0,i.addFilter)("blocks.registerBlockType","wmf-reports/custom-attributes/group-block",(function(t,o){return"core/group"!==o?t:{...t,attributes:{...t.attributes,includeInToC:{type:"boolean",default:!1},tocLabel:{type:"string"},tocSlug:{type:"string"},fullViewportHeight:{type:"boolean",default:!1}},transforms:{...t.transforms,from:[{type:"block",blocks:["wmf-reports/expandable"],transform:(t,o)=>(0,e.createBlock)("core/group",t,o)},...t.transforms.from]}}}));const u=window.wp.richText,w="wmf-reports/count-up";(0,u.registerFormatType)(w,{title:"Count-up Number",tagName:"span",className:"wmf-countup",edit:({isActive:e,onChange:t,value:r})=>(0,l.jsx)(o.RichTextToolbarButton,{icon:(0,l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 16 16",children:[(0,l.jsx)("text",{x:"1",y:"7.5",fontSize:"8",transform:"scale(1 1.75)",children:"0"}),(0,l.jsx)("text",{x:"10",y:"7.5",fontSize:"8",transform:"scale(1 1.75)",children:"9"}),(0,l.jsx)("path",{strokeWidth:"1.5",markerEnd:"url(#a)",d:"M6 8.5h1"}),(0,l.jsx)("defs",{children:(0,l.jsx)("marker",{id:"a",markerHeight:"4.5",markerWidth:"2",orient:"auto",refX:"0",refY:"1.75",children:(0,l.jsx)("path",{d:"m0 0 2 1.75L0 3.5z"})})})]}),title:(0,s.__)("Count-up Number","wmf-reports"),onClick:()=>{t((0,u.toggleFormat)(r,{type:w}))},isActive:e})}),(0,e.registerBlockCollection)("wikimedia-annual-report",{title:"Annual Report",icon:"chart-bar"})})();