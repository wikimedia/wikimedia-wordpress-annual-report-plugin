(()=>{"use strict";document.querySelectorAll(".wp-block-wmf-reports-stories").forEach((e=>{const t=e.getElementsByClassName("wp-block-wmf-reports-story"),i=e.getElementsByClassName("category-slide"),s=e.querySelector(".carousel__buttons .carousel__button--back"),o=e.querySelector(".carousel__buttons .carousel__button--forward"),l=e.querySelector(".stories__categories-buttons .carousel__button--back"),n=e.querySelector(".stories__categories-buttons .carousel__button--forward"),r=t.length,c=e.getElementsByClassName("stories__categories")?.[0],a=e=>{c.style.marginLeft=e+"px"};let d=!1,u=0,y=0;function h(e){if(!e)return;const t=e.querySelector("figure iframe")||e.querySelector("figure");if(t){const i=t.getBoundingClientRect().height,s=e.closest(".carousel-wrapper");s&&i&&s.style.setProperty("--story-slide-graphic-height",`${Math.round(i)}px`)}}window.addEventListener("resize",function(e){let t;return function(...i){clearTimeout(t),t=setTimeout((()=>{e.apply(this,i)}),100)}}((()=>{for(const e of t)if("hidden"!==e.style.visibility)return void h(e)})));const g=(e,s=!0)=>{const o=document.querySelector(".category-slide.active"),l=parseInt(o?.dataset?.index||0),n=t[e];h(n);const u=Array.from(i).filter((e=>e.dataset.id===n.id));Array.from(i).forEach((e=>{e.classList.remove("active")})),u.forEach((e=>{e.classList.add("active");const t=e.closest(".wp-block-group[id]")?.id;s&&e.dataset.id&&(location.hash=`${t}-${e.dataset.id}`,(e=>{const t=e.closest(".stories.carousel");t&&function(e,t){if(t&&function(e){const{top:t,bottom:i}=e.getBoundingClientRect(),{innerHeight:s}=window;return t>=0&&i<=s}(e))return;const i=window.getComputedStyle(document.body).getPropertyValue("--scroll-margin-top")||0;window.scrollTo({behavior:"smooth",top:e.getBoundingClientRect().top-document.body.getBoundingClientRect().top-(parseInt(i,10)+8)})}(t)})(e))})),Array.from(t).forEach(((t,i)=>{if(!d){if(i===e)return t.style.height=null,void(t.style.visibility="visible");if(i===l&&l!==e)return e>=l?(n.style.height=null,n.style.opacity=0,t.style.opacity=1,t.style.position="absolute",t.style.zIndex=1,t.classList.add("animate"),setTimeout((()=>{t.style.height=n.offsetHeight,t.style.opacity=0,d=!0}),1),setTimeout((()=>{t.style.height=0,t.style.opacity=null,t.style.position=null,t.style.visibility="hidden",t.style.zIndex=null,t.classList.remove("animate"),d=!1}),250),n.style.height=null,n.style.opacity=null,void(n.style.visibility="visible")):e<l?(n.style.height=null,n.style.opacity=0,n.style.position="absolute",n.style.visibility="visible",t.style.height=null,t.style.opacity=1,t.style.visibility="visible",setTimeout((()=>{n.classList.add("animate"),t.classList.add("animate")}),1),setTimeout((()=>{n.style.opacity=1,t.style.height=n.offsetHeight+"px",d=!0}),2),setTimeout((()=>{t.style.opacity=0}),250),void setTimeout((()=>{n.style.height=null,n.style.opacity=null,n.style.position=null,n.style.visibility="visible",n.classList.remove("animate"),t.style.height=0,t.style.opacity=null,t.style.visibility="hidden",t.classList.remove("animate"),d=!1}),250)):void 0;t.style.height=0,t.style.visibility="hidden"}})),(e=>{const t=document.getElementsByClassName("stories__categories-wrapper")?.[0],i=document.querySelector(".category-slide.active"),s=document.querySelector(".category-slide:last-child"),o=parseInt(c.style.marginLeft)||0,l=t?.getBoundingClientRect(),n=i?.getBoundingClientRect(),d=s?.getBoundingClientRect();if(!s||d.right-o<l.right)return a(0),void(document.querySelector(".stories__categories-buttons").style.display="none");if(0!==e)if(e!==r-1){if(e>0&&e<r-1){const e=document.querySelector(".category-slide:first-child"),t=n.right-n.left,i=n.left-o,s=(l.right-l.left)/2,r=l.right-s-i+t/2,c=e?.getBoundingClientRect();if(c.left-o+r>l.left)return void a(0);const u=d.right-o;if(u+r<l.right)return void a(l.right-u);a(r)}}else{const e=n.right-n.left,t=n.left-o,i=l.right-(t+e);a(i)}else a(0)})(e)};g(0,!1);const f=t[0]&&t[0].closest(".carousel--uninitialized");f&&f.classList.remove("carousel--uninitialized"),Array.from(i).forEach(((e,t)=>{e.addEventListener("click",(()=>{g(t)}))})),[l,s].forEach((e=>{e&&e.addEventListener("click",(()=>{const e=Array.from(t).findIndex((e=>"visible"===e.style.visibility)),i=e-1<0?t.length-1:e-1;g(i)}))})),[n,o].forEach((e=>{e&&e.addEventListener("click",(()=>{let e=Array.from(t).findIndex((e=>"visible"===e.style.visibility));e<0&&(e=0);const i=e+1>t.length-1?0:e+1;g(i)}))})),c.addEventListener("touchstart",(e=>{u=e.changedTouches[0].screenX})),c.addEventListener("touchend",(e=>{y=e.changedTouches[0].screenX,y<u&&o.click(),y>u&&s.click()})),document.addEventListener("DOMContentLoaded",(()=>{const e=location.hash.slice(location.hash.lastIndexOf("-")+1),t=document.getElementById(e);t&&t.closest(".stories.carousel")&&setTimeout((()=>{const i=[...t.parentElement.children].findIndex((({id:t})=>t===e));g(i)}),500)}))}))})();