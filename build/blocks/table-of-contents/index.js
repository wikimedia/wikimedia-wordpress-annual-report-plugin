(()=>{"use strict";const e=window.wp.blocks,t=window.wp.i18n,o=window.wp.blockEditor,s=window.wp.editPost,i=window.wp.element,l=window.wp.data,n=window.ReactJSXRuntime,c=(0,t.__)("(Waypoint group has no ToC label)","wmf-reports"),r=e=>{const t=[];return e.forEach((e=>{e.attributes.includeInToC&&t.push(e),e.innerBlocks&&r(e.innerBlocks).forEach((e=>{t.push(e)}))})),t},a=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":3,"name":"wmf-reports/table-of-contents","version":"0.1.0","title":"Report Table of Contents","textdomain":"wmf-reports","category":"widgets","icon":"editor-ul","description":"Render a table of contents based on labeled group blocks.","example":{},"supports":{"multiple":false,"html":false},"attributes":{"waypoints":{"type":"string","default":""}},"editorScript":"file:./index.js","style":"file:./index.css","viewScript":"file:./view.js"}');(0,e.registerBlockType)(a.name,{...a,edit:function({setAttributes:e}){const t=(0,l.useSelect)((e=>e(o.store).getBlocks())),{selectBlock:a}=(0,l.useDispatch)(o.store),{openGeneralSidebar:p}=(0,l.useDispatch)(s.store),u=(0,i.useMemo)((()=>r(t).map((e=>({clientId:e.clientId,tocLabel:e.attributes.tocLabel,tocSlug:e.attributes.tocSlug,selectBlock(){a(e.clientId),p("edit-post/block")}})))),[t,a,p]);return(0,i.useEffect)((()=>{e({waypoints:JSON.stringify(u.map((({tocLabel:e,tocSlug:t})=>({tocLabel:e,tocSlug:t}))))})}),[u,e]),(0,n.jsx)("ul",{...(0,o.useBlockProps)(),children:u.map((e=>(0,n.jsx)("li",{children:(0,n.jsx)("a",{href:`#${e.tocSlug}`,onClick:()=>{a(e.clientId),p("edit-post/block")},children:e.tocLabel||c})},`waypoint-${e.clientId}`)))})},save:function({attributes:e}){return(0,n.jsx)("ul",{...o.useBlockProps.save(),children:(JSON.parse(e.waypoints)||[]).map((e=>(0,n.jsx)("li",{children:(0,n.jsx)("a",{href:`#${e.tocSlug}`,children:e.tocLabel})},`waypoint-${e.tocSlug}`)))})}})})();