(()=>{const t=document.querySelector(".wmf-toc-jumplist"),e=t?Array.from(t.querySelectorAll(".wmf-toc-jumplist__items a")):[],o=t?t.querySelector(".wmf-toc-progress"):null,c=200;if(t){const e=document.querySelector(".wp-block-button.has-icon-download");e&&!t.querySelector(".has-icon-download")&&t.querySelector(".wmf-toc-jumplist__modal-footer").prepend(e.cloneNode(!0))}function n(){const o=function(){for(const t of e){const e=t.getAttribute("href"),o=document.querySelector(e).getBoundingClientRect();if(o.top<=c&&o.top+o.height>=c&&o.top+o.height>=0)return t}return null}();if(!o)return;const n=o.getAttribute("href"),r=t.querySelector(".wp-block-button.is-share-button a");if(n&&r&&r.href){const t=r.href;r.href=t.replace(/#.*$/,"")}e.forEach((t=>{t.classList.toggle("wmf-toc-jumplist__active-item",o===t)}))}const r="wmf-toc-jumplist--modal-open";let l=!1;document.querySelector(".wp-block-wmf-reports-table-of-contents")&&(window.addEventListener("scroll",(function(){o&&function(){if(!o)return;const t=(document.querySelector("main")||document.querySelector("article")||document.body).clientHeight,e=document.documentElement.scrollTop,c=+Math.min(e/t*100,100).toFixed(2),n=(100-c)/100;o.setAttribute("style",`width:${c}%`);const r=o.querySelector("circle"),l=+r.getAttribute("r");if(isNaN(l))return;const s=Math.PI*l*2;r.setAttribute("stroke-dashoffset",`${(n*s).toFixed(0)}px`)}(),t&&n()})),window.addEventListener("hashchange",n),document.querySelector(".wmf-toc-progress button").addEventListener("click",(()=>{document.querySelector(".wmf-toc-jumplist").classList.add(r)})),document.addEventListener("click",(({target:t})=>{const e=e=>t?.classList?.contains?.(e);(e("wmf-toc-jumplist__modal-blanket")||e("wmf-toc-jumplist__modal-close")||"A"===t.nodeName&&/^#[A-Za-z0-9-]+$/.test(t.getAttribute("href")))&&document.querySelectorAll(`.${r}`).forEach((t=>t.classList.remove(r)))})),document.addEventListener("scroll",(()=>{window.innerWidth<1024||(!l&&window.scrollY>46?(t.classList.add("wmf-toc-jumplist--pinned"),l=!0):l&&window.scrollY<=46&&(t.classList.remove("wmf-toc-jumplist--pinned"),l=!1))})))})();