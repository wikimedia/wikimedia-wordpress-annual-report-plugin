(()=>{const t=document.querySelector(".wmf-toc-jumplist"),e=t?Array.from(t.querySelectorAll(".wmf-toc-jumplist__items a")):[],o=t?t.querySelector(".wmf-toc-progress"):null;if(t){const e=document.querySelector(".wp-block-button.has-icon-download");e&&!t.querySelector(".has-icon-download")&&t.querySelector(".wmf-toc-jumplist__modal-footer").prepend(e.cloneNode(!0))}function c(){const o=function(){for(const t of e){const e=t.getAttribute("href"),o=document.querySelector(e).getBoundingClientRect();if(o.top<=200&&o.top+o.height>=200&&o.top+o.height>=0)return t}return null}();if(!o)return;const c=o.getAttribute("href"),n=t.querySelector(".wp-block-button.is-share-button a");if(c&&n&&n.href){const t=n.href;n.href=t.replace(/#.*$/,"")}e.forEach((t=>{t.classList.toggle("wmf-toc-jumplist__active-item",o===t)}))}const n="wmf-toc-jumplist--modal-open";let r=!1;document.querySelector(".wp-block-wmf-reports-table-of-contents")&&(window.addEventListener("scroll",(function(){o&&function(){if(!o)return;const t=document.documentElement.scrollHeight-document.documentElement.clientHeight,e=document.documentElement.scrollTop/t*100,c=(100-e)/100;o.setAttribute("style",`width:${e.toFixed(2)}%`);const n=o.querySelector("circle"),r=+n.getAttribute("r");if(isNaN(r))return;const l=Math.PI*r*2;n.setAttribute("stroke-dashoffset",`${(c*l).toFixed(0)}px`)}(),t&&c()})),window.addEventListener("hashchange",c),document.querySelector(".wmf-toc-progress button").addEventListener("click",(()=>{document.querySelector(".wmf-toc-jumplist").classList.add(n)})),document.addEventListener("click",(({target:t})=>{const e=e=>t?.classList?.contains?.(e);(e("wmf-toc-jumplist__modal-blanket")||e("wmf-toc-jumplist__modal-close")||"A"===t.nodeName&&/^#[A-Za-z0-9-]+$/.test(t.getAttribute("href")))&&document.querySelectorAll(`.${n}`).forEach((t=>t.classList.remove(n)))})),document.addEventListener("scroll",(()=>{window.innerWidth<1024||(!r&&window.scrollY>46?(t.classList.add("wmf-toc-jumplist--pinned"),r=!0):r&&window.scrollY<=46&&(t.classList.remove("wmf-toc-jumplist--pinned"),r=!1))})))})();