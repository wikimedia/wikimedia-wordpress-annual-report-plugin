(()=>{"use strict";const e=window.wp.blocks,t=window.wp.i18n,o=window.wp.blockEditor,s=window.wp.components,r=window.wp.data,a=window.wp.element,l=window.ReactJSXRuntime,n=JSON.parse('{"UU":"wmf-reports/overlay"}');(0,e.registerBlockType)(n.UU,{edit:function({attributes:n,clientId:i,setAttributes:c}){const{PostSelectButton:p}=window?.hm?.components||{PostSelectButton:()=>{}},{postId:d,postType:m}=n,w="wikimedia-endow"===wmf.theme,[u,_]=(0,a.useState)(!1),y=(0,r.useSelect)((e=>{const t=e("core/editor").getBlocksByClientId(i);return t&&t[0]&&t[0]?.innerBlocks||[]})),{media:h,post:f}=(0,r.useSelect)((e=>{const t=e("core").getEntityRecord("postType",m,d);return{media:t?.featured_media?e("core").getMedia(t?.featured_media):{},post:t}})),{insertBlocks:v,removeBlocks:g}=(0,r.useDispatch)("core/block-editor");return(0,l.jsxs)("div",{...(0,o.useBlockProps)({className:"overlay"}),children:[!w&&(0,l.jsx)(o.InspectorControls,{children:(0,l.jsxs)(s.PanelBody,{children:[(0,l.jsx)(s.SelectControl,{label:(0,t.__)("Choose Post Type","wmf-reports"),help:(0,t.__)("Altering the post type will allow you to choose posts from that post type using the select post button below.","wmf-reports"),options:[{label:"Post",value:"post"},{label:"Page",value:"page"},{label:"Profile",value:"profile"},{label:"Report",value:"wmf-report"},{label:"Story (Default)",value:"story"}],value:m,onChange:e=>{c({postType:e})}}),(0,l.jsx)(s.BaseControl,{className:"story-base-control",help:(0,t.__)("Associate this post with the overlay. Once you have chosen a post use the button below to refresh the overlay content.","wmf-reports"),id:(0,t.__)("Associated Post","wmf-reports"),label:(0,t.__)("Associated Post","wmf-reports"),children:(0,l.jsx)(p,{maxPosts:1,postType:m,value:[d],onSelect:e=>{const t=e?.[0]?.id||0;0!==t&&c({postId:t})},children:(0,l.jsx)("span",{className:"components-button is-secondary",children:(0,t.__)("Select post","wmf-reports")})})}),0!==d&&(0,l.jsx)(s.BaseControl,{className:"story-base-control",help:(0,t.__)("Pull the overlay content from the associated post.","wmf-reports"),id:(0,t.__)("Refresh Overlay Content","wmf-reports"),label:(0,t.__)("Refresh Overlay Content","wmf-reports"),children:(0,l.jsx)(s.Button,{variant:"secondary",onClick:()=>{if(!d||0===d||!f)return;const t=y.map((e=>e.clientId)),o=f.title.raw||"",s=f?.featured_media||0,r=h?.link,a=f?.content?.raw||"";g(t);const l=wp.blocks.rawHandler({HTML:a}),n=(0,e.createBlock)("core/group",{className:"wmf-pattern-overlay"},[(0,e.createBlock)("core/group",{layout:{type:"flex",orientation:"vertical"}},[(0,e.createBlock)("core/paragraph",{className:"wmf-pattern-overlay__category is-style-sans-p",content:"<strong>Lorem ipsum / Sit amet</strong>",style:{elements:{link:{color:{text:"var:preset|color|orange"}}}},textColor:"orange"}),(0,e.createBlock)("core/heading",{className:"wmf-pattern-overlay__heading is-style-h2",content:`<strong>${o||"Lorem ipsum dolor sit amet imperdiet</strong>"}</strong>`,level:4}),(0,e.createBlock)("core/paragraph",{className:"wmf-pattern-overlay__location is-style-sans-p",content:"<em>Optional line for location</em>"}),(0,e.createBlock)("core/image",{aspectRatio:"4/3",className:"is-style-default wmf-pattern-overlay__image",id:s||74197,lightbox:{aspectRatio:"4/3",className:"is-style-default wmf-pattern-overlay__image",enabled:!1,id:s||74197,linkDestination:"none",scale:"cover",sizeSlug:"full",url:r||"/wp-content/uploads/2024/01/Wikimedia_Foundation_AI_Blog_Series_Header.png"},linkDestination:"none",scale:"cover",sizeSlug:"full",url:r||"/wp-content/uploads/2024/01/Wikimedia_Foundation_AI_Blog_Series_Header.png"})]),...l]);v(n,null,i)},children:(0,t.__)("Refresh Overlay","wmf-reports")})})]})}),(0,l.jsxs)("div",{className:"overlay-container",children:[(0,l.jsx)("div",{className:"overlay-container__navigation",children:(0,l.jsx)(s.Button,{variant:"secondary",onClick:()=>_(!u),children:u?(0,t.__)("Collapse Overlay Content","wmf-reports"):(0,t.__)("Edit Overlay Content","wmf-reports")})}),u&&(0,l.jsx)("div",{className:"overlay-container__inner",children:(0,l.jsx)(o.InnerBlocks,{template:[["core/paragraph",{placeholder:(0,t.__)("Add overlay contentâ€¦","wmf-reports")}]]})})]})]})},save:()=>(0,l.jsx)(o.InnerBlocks.Content,{})})})();