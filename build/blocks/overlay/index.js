(()=>{"use strict";const e=window.React,t=window.wp.blocks,o=window.wp.i18n,a=window.wp.blockEditor,r=window.wp.components,l=window.wp.data,n=window.wp.element,s=JSON.parse('{"UU":"wmf-reports/overlay"}');(0,t.registerBlockType)(s.UU,{edit:function({attributes:s,clientId:c,setAttributes:i}){const{PostSelectButton:p}=window?.hm?.components||{PostSelectButton:()=>{}},{postId:m,postType:d}=s,u="wikimedia-endow"===wmf.theme,[w,_]=(0,n.useState)(!1),y=(0,l.useSelect)((e=>{const t=e("core/editor").getBlocksByClientId(c);return t&&t[0]&&t[0]?.innerBlocks||[]})),{media:f,post:v}=(0,l.useSelect)((e=>{const t=e("core").getEntityRecord("postType",d,m);return{media:t?.featured_media?e("core").getMedia(t?.featured_media):{},post:t}})),{insertBlocks:g,removeBlocks:h}=(0,l.useDispatch)("core/block-editor");return(0,e.createElement)("div",{...(0,a.useBlockProps)({className:"overlay"})},!u&&(0,e.createElement)(a.InspectorControls,null,(0,e.createElement)(r.PanelBody,null,(0,e.createElement)(r.SelectControl,{label:(0,o.__)("Choose Post Type","wmf-reports"),help:(0,o.__)("Altering the post type will allow you to choose posts from that post type using the select post button below.","wmf-reports"),options:[{label:"Post",value:"post"},{label:"Page",value:"page"},{label:"Profile",value:"profile"},{label:"Report",value:"wmf-report"},{label:"Story (Default)",value:"story"}],value:d,onChange:e=>{i({postType:e})}}),(0,e.createElement)(r.BaseControl,{className:"story-base-control",help:(0,o.__)("Associate this post with the overlay. Once you have chosen a post use the button below to refresh the overlay content.","wmf-reports"),id:(0,o.__)("Associated Post","wmf-reports"),label:(0,o.__)("Associated Post","wmf-reports")},(0,e.createElement)(p,{maxPosts:1,postType:d,value:[m],onSelect:e=>{const t=e?.[0]?.id||0;0!==t&&i({postId:t})}},(0,e.createElement)("span",{className:"components-button is-secondary"},(0,o.__)("Select post","wmf-reports")))),0!==m&&(0,e.createElement)(r.BaseControl,{className:"story-base-control",help:(0,o.__)("Pull the overlay content from the associated post.","wmf-reports"),id:(0,o.__)("Refresh Overlay Content","wmf-reports"),label:(0,o.__)("Refresh Overlay Content","wmf-reports")},(0,e.createElement)(r.Button,{variant:"secondary",onClick:()=>{if(!m||0===m||!v)return;const e=y.map((e=>e.clientId)),o=v.title.raw||"",a=v?.featured_media||0,r=f?.link,l=v?.content?.raw||"";h(e);const n=wp.blocks.rawHandler({HTML:l}),s=(0,t.createBlock)("core/group",{className:"wmf-pattern-overlay"},[(0,t.createBlock)("core/group",{layout:{type:"flex",orientation:"vertical"}},[(0,t.createBlock)("core/paragraph",{className:"wmf-pattern-overlay__category is-style-sans-p",content:"<strong>Lorem ipsum / Sit amet</strong>",style:{elements:{link:{color:{text:"var:preset|color|orange"}}}},textColor:"orange"}),(0,t.createBlock)("core/heading",{className:"wmf-pattern-overlay__heading is-style-h2",content:`<strong>${o||"Lorem ipsum dolor sit amet imperdiet</strong>"}</strong>`,level:4}),(0,t.createBlock)("core/paragraph",{className:"wmf-pattern-overlay__location is-style-sans-p",content:"<em>Optional line for location</em>"}),(0,t.createBlock)("core/image",{aspectRatio:"4/3",className:"is-style-default wmf-pattern-overlay__image",id:a||74197,lightbox:{aspectRatio:"4/3",className:"is-style-default wmf-pattern-overlay__image",enabled:!1,id:a||74197,linkDestination:"none",scale:"cover",sizeSlug:"full",url:r||"/wp-content/uploads/2024/01/Wikimedia_Foundation_AI_Blog_Series_Header.png"},linkDestination:"none",scale:"cover",sizeSlug:"full",url:r||"/wp-content/uploads/2024/01/Wikimedia_Foundation_AI_Blog_Series_Header.png"})]),...n]);g(s,null,c)}},(0,o.__)("Refresh Overlay","wmf-reports"))))),(0,e.createElement)("div",{className:"overlay-container"},(0,e.createElement)("div",{className:"overlay-container__navigation"},(0,e.createElement)(r.Button,{variant:"secondary",onClick:()=>_(!w)},w?(0,o.__)("Collapse Overlay Content","wmf-reports"):(0,o.__)("Edit Overlay Content","wmf-reports"))),w&&(0,e.createElement)("div",{className:"overlay-container__inner"},(0,e.createElement)(a.InnerBlocks,{template:[["core/paragraph",{placeholder:(0,o.__)("Add overlay contentâ€¦","wmf-reports")}]]}))))},save:()=>(0,e.createElement)(a.InnerBlocks.Content,null)})})();